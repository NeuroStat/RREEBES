---
title: "Morales-Castilla et al. (2015, TREE) Inferring biotic interactions from proxies."
author: "Vanessa, Gian-Marco, Thomas"
date: "June 16, 2015"
output: html_document
---

## Introduction

This is the reproduction of the analyses presented in the article *Inferring biotic interactions from proxies* by Ignacio Morales-Castilla, Miguel G. Matias, Dominique Gravel, and Miguel B. Ara??jo (2015, TREE). The article can be found [here](http://www.sciencedirect.com/science/article/pii/S0169534715000774).




## Load data

Clear R environment and load libraries.
```{r}
# Clear workspace.
rm(list=ls())

# Load libraries.
library(igraph)
library(RCurl)
```

Load the data from GitHub straight into R.

Serengeti food web.
```{r}
# Species in the Serengeti food web.
dd <-  getURL("https://raw.githubusercontent.com/opetchey/RREEBES/master/MORALES-CASTILLA_etal_2015_TREE/Data/Serengeti%20data/journal.pcbi.1002321.s004.CSV",
             cainfo = system.file("CurlSSL", "cacert.pem", package = "RCurl"))
dd.01 <- read.csv(text = dd)
# Feeding links in the Serengeti food web.
dd <-  getURL("https://raw.githubusercontent.com/opetchey/RREEBES/master/MORALES-CASTILLA_etal_2015_TREE/Data/Serengeti%20data/journal.pcbi.1002321.s005.CSV",
             cainfo = system.file("CurlSSL", "cacert.pem", package = "RCurl"))
dd.02 <- read.csv(text = dd)
# Consensus partition.
dd <-  getURL("https://raw.githubusercontent.com/opetchey/RREEBES/master/MORALES-CASTILLA_etal_2015_TREE/Data/Serengeti%20data/journal.pcbi.1002321.s006.CSV",
             cainfo = system.file("CurlSSL", "cacert.pem", package = "RCurl"))
dd.03 <- read.csv(text = dd)
# Link densities between groups in the consensus partition.
dd <-  getURL("https://raw.githubusercontent.com/opetchey/RREEBES/master/MORALES-CASTILLA_etal_2015_TREE/Data/Serengeti%20data/journal.pcbi.1002321.s007.CSV",
             cainfo = system.file("CurlSSL", "cacert.pem", package = "RCurl"))
dd.04 <- read.csv(text = dd)
```

Calculate the number of species and the number of potential links one could expect from this.
```{r}
# Species only in Cuban food web.
n.species.Serengeti       <- length(dd.01[,1])
n.links.species.Serengeti <- n.species.Serengeti^2-n.species.Serengeti

```




**Note**: 

* 



The cuban coral reef food web.
```{r}
dd <-  getURL("https://raw.githubusercontent.com/opetchey/RREEBES/Morales-Castilla_etal_2015_TREE/MORALES-CASTILLA_etal_2015_TREE/Data/Coral%20reef%20data/857470.item.4%20-%20Guild%20key%2C%20all%20data%20sets.csv",
             cainfo = system.file("CurlSSL", "cacert.pem", package = "RCurl"))
dd.05 <- read.csv(text = dd)
str(dd.05)
# Convert 'dd.05$Guild.Number' frmo integer to factor.
dd.05$Guild.Number   <- as.factor(dd.05$Guild.Number)
# str(dd.05)

# Only data with species from the Cuban food web.
# Guilds only in Cuban food web.
dd.05.a              <- subset(dd.05, Cuba=="x")
n.guilds.Cuba        <- length(levels(factor(dd.05.a$Guild.Number)))

# Species only in Cuban food web.
n.species.Cuba       <- length(subset(dd.05, Cuba=="x")$Cuba)
n.links.species.Cuba <- n.species.Cuba^2-n.species.Cuba

# Species and guilds in all three food webs.
dd.05.b              <- subset(dd.05, Cuba=="x" | Jamaica=="x" | Cayman.Islands=="x")
n.species.all        <- length(dd.05.b[,1])
n.links.species.all  <- n.species.all^2-n.species.all 
n.guilds.all         <- length(levels(factor(dd.05.b$Guild.Number)))
n.links.guilds.all   <- n.guilds.all^2-n.guilds.all

```

**Note**: 

* Well, overall there are **175 species** in the three food webs, and **171 species** in the Cuban food web. This would give a total number of potential links of **30.450** or **29.070**, respectively. 

* There are **144 guilds** in all three food webs and **140 guilds** in the Cuban one. Based on guilds, this would give a a total number of links of **20.592** or **19.460**, respectively. The question is: where do the 231 species/guilds come from that Ingacio Morales-Castilla was telling us entered their calculations...?!?

## How to...?

"*The procedure for building the backbone of an interaction network starts with the identification of species more likely to share similar interactions. The concept is similar to that of modules [28], but we avoid this terminology because modules are usually determined a posteriori and can also refer to simple assemblages of species such as linear food chains or apparent competition [29]. Instead, we define interacting groups based on a priori expectations of interactions. The concept is also analogous to that of guilds [30]. Guilds, however, are restricted to species shar- ing similar resources, and thus do not encompass non- consumptive interactions such as competition or niche construction [27]. A flexible definition of interacting groups based on traits, phylogenies, and geographical distribu- tions would enable combination of heterogeneous information.*" (page 4, bottom-right)

## Serengeti foob web analysis

```{r}

### get the data
g <- graph.data.frame(dd.02, directed=TRUE, vertices=NULL)
dim(g)
tkplot(g)


```

## Cuban coral reef food web









